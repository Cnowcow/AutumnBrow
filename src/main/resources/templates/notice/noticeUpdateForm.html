<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>
    <title>공지사항 수정</title>
    <link href="/css/styles.css" rel="stylesheet"/>
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
</head>
<body class="sb-nav-fixed">

<!-- header -->
<div th:insert="~{/header.html}"></div>

<div id="layoutSidenav">

    <!-- sidebar -->
    <div th:insert="~{/sidebar.html}"></div>

    <div id="layoutSidenav_content">

        <!-- 메인화면 -->
        <main>
            <div class="container mb-5">
                <div class="row justify-content-center">
                    <div class="col-lg-7">
                        <div class="card shadow-lg border-0 rounded-lg mt-5">
                            <div class="card-header"><h3 class="text-center font-weight-light my-4">공지사항 수정</h3>
                            </div>
                            <div class="card-body">
                                <form th:object="${notices}" method="post" enctype="multipart/form-data">
                                    <input type="hidden" th:field="*{noticeId}"/>
                                    <div class="mb-3">
                                        <label for="title" class="form-label">제목</label>
                                        <input class="form-control" id="title" name="title" type="text" th:field="*{title}" placeholder="제목을 입력하세요."/>
                                    </div>

                                    <div class="mb-3">
                                        <label for="content" class="form-label">내용</label>
                                        <textarea class="form-control" id="content" name="content" placeholder="내용을 입력하세요."
                                                  style="height: 200px;" maxlength="1000" th:field="*{content}"></textarea>
                                    </div>

                                    <div class="row mb-5">
                                        <div class="col-md-6">
                                            <label for="noticeImage" class="form-label">사진 변경</label>
                                            <div class="mb-3">
                                                <img id="beforeImagePreview" th:src="@{|http://hhjnn92.synology.me/AutumnBrow/notice/*{noticeUrl}|}" style="max-width: 400px; max-height: 300px; cursor: pointer;" onclick="openImageInNewWindow(this.src)" />
                                            </div>
                                            <input class="form-control" id="noticeImage" name="noticeImage" type="file" accept="image/*" onchange="previewImage(event, 'beforeImagePreview')" />
                                        </div>
                                    </div>

                                    <div class="mb-4">
                                        <label for="important" class="form-label">중요 공지사항</label>
                                        <input id="important" name="important" type="checkbox" th:checked="*{important == 'Y'}" style="margin-left: 10px; transform: scale(1.5);" />
                                    </div>

                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <button type="submit" class="btn btn-primary">저장</button>
                                            <button type="button" class="btn btn-secondary" onclick="window.location.href='/notice/update'">취소</button>
                                        </div>
                                        <button type="button" class="btn btn-danger" th:value="${noticeId}" onclick="postDelete(this.value)">삭제</button>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>


        <!--<main>
            <div class="container mb-5">
                <article class="col-md-12 justify-content-center">

                    <div id="noticeTitle" class="justify-content-center mt-5 mb-3 border">
                        <h2><input type="text" class="p-3 fw-bold w-100" th:value="${notices.title}" placeholder="제목을 입력하세요."></h2>
                        <div class="bg-light p-3 d-flex justify-content-between">
                            <div class="d-flex p-2">
                                <label for="important" class="form-label">중요 공지사항</label>
                                <input id="important" name="important" type="checkbox" th:checked="*{notices.important == 'Y'}" style="margin-left: 10px; transform: scale(1.5);" />
                            </div>
                            <div class="text-secondary p-2">
                                <i class="fas fa-clock"></i> <span th:text="${#temporals.format(notices.noticeDate, 'YYYY.MM.dd HH:mm')}"></span>
                            </div>
                        </div>
                    </div>

                    <div id="noticeImage" class="text-center">
                        <img class="col-md-8" th:src="'http://hhjnn92.synology.me/AutumnBrow/notice/'+${notices.noticeUrl}" width="100%"/>
                    </div>

                    <div id="noticeBody" class="col-md-11 mt-5 mb-5 p-2 row justify-content-center">
                        <span class="fs-5" th:text="${notices.content}"></span>
                    </div>

                    <div id="noticeComment">
                    </div>
                </article>


            </div>
        </main>-->
        <!-- 메인화면 끝 -->

        <!-- footer -->
        <div th:insert="~{/footer.html}"></div>

    </div>
</div>


<script>
    function previewImage(event, previewId) {
        const fileInput = event.target;
        const previewImg = document.getElementById(previewId);

        if (fileInput.files && fileInput.files[0]) {
            const reader = new FileReader();

            reader.onload = function(e) {
                previewImg.src = e.target.result;
            }

            reader.readAsDataURL(fileInput.files[0]);
        }
    }

    function openImageInNewWindow(imageSrc) {
        window.open(imageSrc, '_blank', 'toolbar=no,scrollbars=yes,resizable=yes,width=800,height=600');
    }

</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>
<script src="/js/scripts.js"></script>

</body>
</html>
